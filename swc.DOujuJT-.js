import{w as e}from"./swc.BkWj9Vim.js";import{e as s,i as t,t as r}from"./swc.8Y9xgsp7.js";import{p as o,v as l,r as n,h as i,m as u}from"./swc.BGFXP_Ok.js";const f=(e,s,t)=>{const r=new Map;for(let o=s;o<=t;o++)r.set(e[o],o);return r},c=s(class extends t{constructor(e){if(super(e),e.type!==r.CHILD)throw Error("repeat() can only be used in text expressions")}dt(e,s,t){let r;void 0===t?t=s:void 0!==s&&(r=s);const o=[],l=[];let n=0;for(const s of e)o[n]=r?r(s,n):n,l[n]=t(s,n),n++;return{values:l,keys:o}}render(e,s,t){return this.dt(e,s,t).values}update(s,[t,r,c]){const a=o(s),{values:d,keys:h}=this.dt(t,r,c);if(!Array.isArray(a))return this.ut=h,d;const p=this.ut??=[],v=[];let m,y,w=0,g=a.length-1,x=0,j=d.length-1;for(;w<=g&&x<=j;)if(null===a[w])w++;else if(null===a[g])g--;else if(p[w]===h[x])v[x]=l(a[w],d[x]),w++,x++;else if(p[g]===h[j])v[j]=l(a[g],d[j]),g--,j--;else if(p[w]===h[j])v[j]=l(a[w],d[j]),n(s,v[j+1],a[w]),w++,j--;else if(p[g]===h[x])v[x]=l(a[g],d[x]),n(s,a[w],a[g]),g--,x++;else if(void 0===m&&(m=f(h,x,j),y=f(p,w,g)),m.has(p[w]))if(m.has(p[g])){const e=y.get(h[x]),t=void 0!==e?a[e]:null;if(null===t){const e=n(s,a[w]);l(e,d[x]),v[x]=e}else v[x]=l(t,d[x]),n(s,a[w],t),a[e]=null;x++}else i(a[g]),g--;else i(a[w]),w++;for(;x<=j;){const e=n(s,v[j+1]);l(e,d[x]),v[x++]=e}for(;w<=g;){const e=a[w++];null!==e&&i(e)}return this.ut=h,u(s,v),e}});export{c};
//# sourceMappingURL=swc.BFbF3Dv8.js.map
